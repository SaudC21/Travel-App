!function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";async function o(t){const e=await fetch(t);try{const t=await e.json();return console.log("req.js L6: ",t),t}catch(t){console.log("ERORR",t)}}async function a(t){const e=await fetch(t);try{return await e.json()}catch(t){console.log("error: ",t)}}n.r(e),n.d(e,"updatUI",(function(){return C}));const r=async(t="",e={})=>{const n=await fetch(t,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});try{return await n.json()}catch(t){console.log("Error: ",t)}};let i,c,u,l,s=document.getElementById("destination"),d={latitude:"notFound",lngitude:"notFound",city:"notFound",country:"notFound",countryCode:"notFound"};async function y(){try{console.log("\n            cordinatesHandler\n        ");let t="/getApiKey";await o(t).then((async function(t){return await async function(t){console.log(`\n        GeonamesAPI L16${t.GEONAMES_USERNAME}\n    `);const e=`http://api.geonames.org/searchJSON?q=${s.value}&maxRows=1&username=${t.GEONAMES_USERNAME}`;return c=await a(e),0==c.totalResultsCount?(alert("Please re-enter a correct destination"),d):(i=c.geonames[0],d={latitude:i.lat,lngitude:i.lng,city:i.name,country:i.countryName,countryCode:i.countryCode},d)}(t)})).then((async function(t){return"notFound"==d.city?void await r("/postCordinates",d):await r("/postCordinates",t)}))}catch(t){console.log("Error: ",t)}}let g={description:"notFound"};async function f(){try{let t="/getApiKey";await o(t).then((async function(t){return await async function(t){if(u=await E(),"notFound"==u.latitude)return g;{let e=`https://api.weatherbit.io/v2.0/forecast/daily?lat=${u.latitude}&lon=${u.lngitude}&key=${t.WEAHTERBIT_KEY}`;return l=await a(e),g=l.data[0],g}}(t)})).then((async function(t){return"notFound"==t.description?void await r("/postweather",t):await r("/postweather",t)}))}catch(t){console.log("Error: ",t)}}let p,m,h=document.getElementById("destination");async function w(){try{let t="/getApiKey";await o(t).then((async function(t){return await async function(t){let e=`https://pixabay.com/api/?key=${t.PIXABAY_KEY}&q=${h.value}&orientation=horizontal&category=buildings&per_page=3`;return m=await a(e),0==m.hits.length&&(p=await E(),e=`https://pixabay.com/api/?key=${t.PIXABAY_KEY}&q=${p.country}&orientation=horizontal&category=buildings&per_page=3`,m=await a(e)),{url:m.hits[0].webformatURL}}(t)})).then((async function(t){return await r("/postImgURL",t)}))}catch(t){console.log("Error: ",t)}}document.getElementById("destination"),document.getElementById("departure");async function E(){let t=await fetch("/getCordinates");try{return await t.json()}catch(t){console.log("ERROR: ",t)}}const b=document.getElementById("btnSubmit"),I=document.getElementById("departure"),M=document.getElementById("destination");let R,T,v,B,S;const O=document.getElementById("card-container"),$=document.getElementById("cityImg"),j=document.getElementById("desTitle"),L=document.getElementById("countdown"),A=(document.getElementById("weatherIcon"),document.getElementById("temp")),F=document.getElementById("description");function _(){R=new Date;let t=String(R.getDate()).padStart(2,"0"),e=String(R.getMonth()+1).padStart(2,"0"),n=R.getFullYear();return R=n+"-"+e+"-"+t,function(t,e){const n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),o=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return Math.floor((o-n)/864e5)}(new Date(R),new Date(I.value))}async function C(){console.log("\n        updatUI Method\n    "),O.style="",$.src="",L.innerHTML="",F.innerHTML="",A.innerHTML="",j.innerHTML="",v=await async function(){let t=await fetch("/getWeather");try{return await t.json()}catch(t){console.log("ERROR: ",t)}}(),B=await E(),console.log(B),S=await async function(){let t=await fetch("/getImgURL");try{return await t.json()}catch(t){console.log("ERROR: ",t)}}(),console.log(S),T=_(),O.style="background-color: #778592;",$.src=S.url,L.innerHTML=`Your Distination in ${T} days`,F.innerHTML=v.weather.description,A.innerHTML=`${Math.round(v.temp)}Â°C`,B.city.length+B.country.length<=20?j.innerHTML=`${B.city} ${B.country}`:j.innerHTML=`${B.city} ${B.countryCode}`}b.addEventListener("click",(async()=>{""==M.value?alert("Please enter your destination"):""==I.value?alert("Please enter your departure date"):async function(){console.log("\n        Handlesubmit Method\n    "),await y(),"notFound"!=(await E()).city&&(await f(),await w(),C())}()}))}]);